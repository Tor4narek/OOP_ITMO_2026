# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4

## –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ Entity Framework Core.


## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–û—Å–≤–æ–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–∏–º–∏ –∏–∑ C#-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Entity Framework Core**.

–í —Ä–∞–º–∫–∞—Ö —Ä–∞–±–æ—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç:

* –∑–Ω–∞–∫–æ–º–∏—Ç—Å—è —Å –æ—Å–Ω–æ–≤–∞–º–∏ SQL;
* —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—ë—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü—ã –≤ **SQL Server**;
* –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö;
* —Ä–µ–∞–ª–∏–∑—É–µ—Ç **CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏** —á–µ—Ä–µ–∑ EF Core;
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω **Repository** –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –æ—Ç —Å–ø–æ—Å–æ–±–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.


## –í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞

–ù–æ–º–µ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Äî –Ω–æ–º–µ—Ä –≤ –∂—É—Ä–Ω–∞–ª–µ.

–ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–º, –≤—ã–±—Ä–∞–Ω–Ω—ã–º –≤ **–õ–†-1, –õ–†-2 –∏ –õ–†-3**.
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.


## –û–±—â–∞—è –∏–¥–µ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏, —Ö—Ä–∞–Ω—è—â–∏–º–∏—Å—è –≤ **—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö SQL Server**.

* –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î
* –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞—ë—Ç—Å—è **–≤—Ä—É—á–Ω—É—é**, –≤–Ω–µ C#
* –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **EF Core**
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IRepository<T>`
* –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ø–æ—Å–æ–±–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
* –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (–∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ)


## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞: SQL

–ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç **–æ–±—è–∑–∞–Ω** –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –æ—Å–Ω–æ–≤–∞–º–∏ SQL.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ

–ü—Ä–æ–π—Ç–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫—É—Ä—Å:

üëâ [https://sql-academy.org/ru/guide](https://sql-academy.org/ru/guide)

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω–∏–º–∞—Ç—å:

* `CREATE TABLE`
* `PRIMARY KEY`
* `FOREIGN KEY`
* `INSERT`
* `SELECT`
* `UPDATE`
* `DELETE`
* `WHERE`
–ù–∞ –∑–∞—â–∏—Ç–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π –∫—É—Ä—Å.


## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ


## 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ó–∞–¥–∞—á–∞

–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **SQL Server**
* –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é:

  * —á–µ—Ä–µ–∑ SQL Server Management Studio
    **–∏–ª–∏**
  * —á–µ—Ä–µ–∑ SQL-—Å–∫—Ä–∏–ø—Ç
* –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—É—â–Ω–æ—Å—Ç—è–º –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
* –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å:

  * –ø–µ—Ä–≤–∏—á–Ω—ã–µ –∫–ª—é—á–∏ (`PRIMARY KEY`)
  * –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ (`FOREIGN KEY`) ‚Äî –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
  * –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (`NOT NULL`, `UNIQUE`) ‚Äî –ø–æ –∂–µ–ª–∞–Ω–∏—é

üìå **EF Core –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ö–µ–º—É –ë–î**


## 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ EF Core –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ë–î

### –ó–∞–¥–∞—á–∞

–ü–æ–¥–∫–ª—é—á–∏—Ç—å C#-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Entity Framework Core**
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä **Microsoft.EntityFrameworkCore.SqlServer**
* –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `appsettings.json`

–ü—Ä–∏–º–µ—Ä:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=.;Database=Lab4Db;Trusted_Connection=True;"
  }
}
```


## 3. DbContext

### –ó–∞–¥–∞—á–∞

–°–æ–∑–¥–∞—Ç—å `DbContext`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* `DbContext` –¥–æ–ª–∂–µ–Ω:

  * —Å–æ–¥–µ—Ä–∂–∞—Ç—å `DbSet<T>` –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏;
  * –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏;
* –ó–∞–ø—Ä–µ—â–µ–Ω–æ:

  * –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏;
  * –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `EnsureCreated()`;
  * –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ë–î.

–ü—Ä–∏–º–µ—Ä:

```csharp
public class AppDbContext : DbContext
{
    public DbSet<User> Users { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder options)
    {
        options.UseSqlServer(
            ConfigurationManager
                .ConnectionStrings["DefaultConnection"]
                .ConnectionString
        );
    }
}
```


## 4. –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ —Ç–∞–±–ª–∏—Ü

### –ó–∞–¥–∞—á–∞

–û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ C#-–∫–ª–∞—Å—Å–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü –ë–î.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã:

  * `[Table]`
  * `[Key]`
  * `[Column]`
* –°–≤–æ–π—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–æ–≤ –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª—è–º —Ç–∞–±–ª–∏—Ü
* –ö–ª–∞—Å—Å –æ–±—è–∑–∞–Ω —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å `IEntity`

–ü—Ä–∏–º–µ—Ä:

```csharp
[Table("Users")]
public class User : IEntity
{
    [Key]
    public Guid Id { get; set; }

    [Column("Name")]
    public string Name { get; set; }
}
```


## 5. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π EF Core

### –ó–∞–¥–∞—á–∞

–°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é `IRepository<T>` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î —á–µ—Ä–µ–∑ EF Core.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ç–æ—Ç –∂–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IRepository<T>`**, —á—Ç–æ –≤ –õ–†-2 –∏ –õ–†-3
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏:

  * Create
  * Read
  * Update
  * Delete
* –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DbContext` –∏ `DbSet<T>`



## 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –ó–∞–¥–∞—á–∞

–ó–∞–º–µ–Ω–∏—Ç—å —Ñ–∞–π–ª–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ –õ–†-3 –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π EF Core.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* –í `Main` –∏ —Å–µ—Ä–≤–∏—Å–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ `IRepository<T>`
* –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ **–Ω–µ –¥–æ–ª–∂–Ω–∞ –∏–∑–º–µ–Ω—è—Ç—å—Å—è**
* –ú–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö


## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–í –ø—Ä–æ–≥—Ä–∞–º–º–µ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:

* SQL Server
* —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î
* Entity Framework Core
* `DbContext`
* `DbSet<T>`
* `class`, `interface`, `Generics`
* `async / await`
* –ø–∞—Ç—Ç–µ—Ä–Ω Repository
* CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏


## –ó–∞–ø—Ä–µ—â–µ–Ω–æ

* –ú–∏–≥—Ä–∞—Ü–∏–∏ EF Core
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î
* `EnsureCreated()`
* ADO.NET
* –í–Ω–µ—à–Ω–∏–µ ORM
* –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏


## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

### –ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã (8 –±–∞–ª–ª–æ–≤)

* **4 –±–∞–ª–ª–∞** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ EF Core
* **2 –±–∞–ª–ª–∞** ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–æ–¥–µ–ª–µ–π —Å—Ö–µ–º–µ –ë–î
* **2 –±–∞–ª–ª–∞** ‚Äî –ª–æ–≥–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

### –ó–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç—ã (7 –±–∞–ª–ª–æ–≤)

* **2 –±–∞–ª–ª–∞** ‚Äî –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î
* **2 –±–∞–ª–ª–∞** ‚Äî –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–æ–ª–∏ EF Core
* **3 –±–∞–ª–ª–∞** ‚Äî –æ—Ç–≤–µ—Ç—ã –ø–æ —Ç–µ–º–∞–º:

  * SQL
  * DbContext
  * Repository
  * —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

* [https://sql-academy.org/ru/guide](https://sql-academy.org/ru/guide)
* [https://learn.microsoft.com/ru-ru/ef/core/](https://learn.microsoft.com/ru-ru/ef/core/)
* [https://learn.microsoft.com/ru-ru/ef/core/dbcontext-configuration/](https://learn.microsoft.com/ru-ru/ef/core/dbcontext-configuration/)
* [https://learn.microsoft.com/ru-ru/dotnet/csharp/fundamentals/tutorials/oop](https://learn.microsoft.com/ru-ru/dotnet/csharp/fundamentals/tutorials/oop)
