# Лабораторная работа №2 - Коллекции, Generics, делегаты и LINQ


## Цель работы

Освоение работы с **обобщениями (Generics), делегатами и лямбда-выражениями** в C#, а также использование **LINQ** для обработки данных из консольного приложения. Развитие навыков создания расширяемой архитектуры для работы с коллекциями и анализа данных.

## Выбор варианта

Номер варианта — номер в журнале.

**[Список вариантов](/lab2_variants.md)**

Вариант определяет **предметную область** и набор **отчетов/выборок**, которые студент должен реализовать с помощью LINQ.


## Общая идея приложения

Приложение будет **наследовать структуру и предметную область первой лабораторной работы**.

* Все данные хранятся в **памяти программы**.
* Используются **коллекции** (`List<T>` или репозиторий с Generics).
* Приложение работает в рамках одного запуска.
* Архитектура должна допускать дальнейшее расширение.
* Студенты добавляют **обобщения и делегаты** для универсальной работы с сущностями.


## Техническое задание

### 1. Универсальный репозиторий (Generics)

**Задача:**

Создать обобщённый репозиторий для работы с сущностями предметной области.

#### Требования:

* Создать интерфейс `IEntity` с `int Id { get; }`.
* Все сущности должны реализовывать `IEntity`.
* Создать интерфейс репозитория:

```csharp
public interface IRepository<T> where T : IEntity
{
    void Add(T entity);
    IReadOnlyList<T> GetAll();
    T? GetById(int id);
    void Remove(int id);
    IReadOnlyList<T> Find(Func<T, bool> predicate);
}
```

* Реализовать класс `InMemoryRepository<T>`:

  * хранение коллекции `List<T>` в памяти,
  * проверка уникальности `Id` при добавлении (`InvalidOperationException`),
  * реализация метода `Find(Func<T, bool> predicate)` для поиска элементов по условию.

**Примечание:** `Find` используется с лямбда-выражениями для делегатов.


### 2. Интеграция репозитория с приложением

**Задача:**

Заменить все прямые обращения к `List<T>` на использование `IRepository<T>`.

#### Требования:

* Хранить сущности через универсальный репозиторий.
* Взаимодействие с пользователем через консоль (меню):

  * выполнение основного действия предметной области,
  * вывод текущего состояния данных,
  * выход.
* Использовать `Find(Func<T, bool> predicate)` для поиска и фильтрации объектов по условию.
* Пример использования:

```csharp
IRepository<User> userRepository = new InMemoryRepository<User>();
userRepository.Add(new User { Id = 1, Name = "Alex" });

var foundUsers = userRepository.Find(u => u.Name.StartsWith("A"));
```


### 3. Обработка данных с LINQ

**Задача:**

На основе данных предметной области выполнить **отчеты с использованием LINQ**:

* фильтрация (`Where`),
* проекция (`Select`),
* сортировка (`OrderBy`, `OrderByDescending`),
* группировка (`GroupBy`),
* соединение коллекций (`Join`).

#### Требования:

* Каждый студент реализует **не менее 3–5 отчетов**, специфичных для его варианта.
* Использовать коллекции, полученные из репозитория.
* Отчеты должны выводиться на консоль в читаемом виде.


## Требования к реализации

В программе обязательно должно быть использовано:

* `class`, `interface`, Generics (`<T>`),
* `ref`, `out` при необходимости,
* `Func<T, bool>` (делегаты) и лямбда-выражения,
* `IReadOnlyList<T>` и коллекции `List<T>`,
* LINQ методы (`Where`, `Select`, `OrderBy`, `GroupBy`, `Join`).

### Разрешено:

* Коллекции (`List<T>`),
* Консольный ввод/вывод,
* Стандартные библиотеки C#.

### Запрещено:

* Работа с файлами,
* Базы данных,
* Внешние библиотеки (кроме LINQ),
* Сериализация.


## Критерии оценки

### Код программы (6 баллов):

* **2 балла** — корректная работа репозитория и LINQ-отчетов,
* **2 балла** — логичная и расширяемая архитектура,
* **2 балла** — осмысленное использование Generics и делегатов.

### Защита работы (6 баллов):

* **1 балл** — объяснение архитектуры и репозитория,
* **3 балла** — обоснование проектных решений и делегатов,
* **2 балла** — ответы по темам лекций 3.

---

## Полезные ссылки

* [Обобщения в C#](https://learn.microsoft.com/ru-ru/dotnet/csharp/programming-guide/generics/)
* [Коллекции и интерфейсы](https://learn.microsoft.com/ru-ru/dotnet/csharp/collections/)
* [Делегаты, лямбды и Func/Action](https://learn.microsoft.com/ru-ru/dotnet/csharp/programming-guide/delegates/)
* [LINQ для начинающих](https://learn.microsoft.com/ru-ru/dotnet/csharp/programming-guide/concepts/linq/)
* [LINQ методы](https://learn.microsoft.com/ru-ru/dotnet/csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax)

